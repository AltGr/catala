@@Métadonnées@@

/*
# Une structure regroupe des données ensemble
déclaration structure Enfant :
  donnée fin_obligation_scolaire contenu date
  donnée âge contenu entier
  donnée rémuneration contenu montant

déclaration structure Ménage :
  donnée enfants collection contenu Enfant
  donnée enfant_plus_âgé contenu Enfant optionnel
# Le mot optionnel permet de prévoir le cas où le
# ménage n'a pas d'enfants
  donnée ressources contenu montant

déclaration structure L512_3 :
  donnée âge_limite_alinéa_2 contenu entier
  donnée plafond_rémunération_alinéa_2 contenu montant
  condition droits_ouverts_prestations_familiales

déclaration structure L521_1 :
  donnée allocations_familiales contenu montant
  condition droits_ouverts_allocations_familiales
  donnée allocation_forfaitaire contenu montant
  condition allocation_forfaitaire_versée
  donnée nombre_minimum_enfants contenu montant

déclaration structure L521_3 :
  donnée âge_limite_alinéa_1 contenu entier dépend de Enfant
# L'âge limite dépend de l'enfant considéré,
# au contraire des autres données
  donnée minimum_alinéa_2 contenu montant
  condition droits_ouverts_majorations_allocations_familiales
  donnée majorations_allocations_familiales contenu montant

déclaration champ d'application PrestationsFamiliales :
# Les règles déclarées dans PrestationsFamiliales pourront utiliser
# ménage et l512_3 et leur données associées
  contexte ménage structure Ménage
  contexte l512_3 structure L512_3

déclaration champ d'application AllocationsFamiliales :
  contexte ménage structure Ménage
  contexte l521_1 structure L521_1
  contexte l521_3 structure L521_3
inclus champ d'application PrestationsFamiliales contexte
   AllocationsFamiliales.ménage = PrestationsFamiliales.ménage
# AllocationsFamiliales est un cas particulier de PrestationsFamiliales,
# le dernier est donc inclus dans l'autre. Il est nécessaire de préciser
# que les deux contextes parlent du même ménage pour caractériser l'inclusion.
inclus champ d'application AllocationFamilialesAvril2008

déclaration champ d'application AllocationsFamilialesAvril2008 :
  contexte l521_3 structure L521_3
*/

@@Code de la sécurité sociale@@

@Article L512-3@
Sous réserve des règles particulières à chaque prestation, ouvre droit aux prestations familiales :

1°) tout enfant jusqu’à la fin de l’obligation scolaire ;
/*
champ d'application PrestationsFamiliales :
  règle sous condition
    existe enfant dans ménage.enfants tel que
      date_aujourd_hui <= enfant.fin_obligation_scolaire
  conséquence l512_3.droits_ouverts_prestations_familiales rempli
*/

2°) après la fin de l’obligation scolaire, et jusqu’à un âge limite, tout enfant dont la rémunération éventuelle n’excède pas un plafond
/*
champ d'application PrestationsFamiliales :
  règle sous condition
    existe enfant dans ménage.enfants tel que
      date_aujourd_hui > enfant.fin_obligation_scolaire et
      enfant.rémunération <= l512_3.plafond_rémunération_alinéa_2 et
      enfant.âge < l512_3.âge_limite_alinéa_2
  conséquence l512_3.droits_ouverts_prestations_familiales rempli
*/

@Article L521-1@
Les allocations familiales sont dues à partir du deuxième enfant à charge.
/*
champ d'application AllocationsFamiliales :
  règle sous condition
    nombre de ménage.enfants >= 2
  conséquence l521_1.droits_ouverts_allocations_familiales rempli
*/

Une allocation forfaitaire par enfant d'un montant fixé par décret est versée pendant un an à la personne ou au ménage qui assume la charge d'un nombre minimum d'enfants également fixé par décret lorsque l'un ou plusieurs des enfants qui ouvraient droit aux allocations familiales atteignent l'âge limite mentionné au 2° de l'article L. 512-3. Cette allocation est versée à la condition que le ou les enfants répondent aux conditions autres que celles de l'âge pour l'ouverture du droit aux allocations familiales.
/*
champ d'application AllocationsFamiliales :
  assertion l521_1.allocation_forfaitaire fixé par décret

  assertion
    l521_1.allocation_forfaitaire_versée si et seulement si
    l521_1.allocation_forfaitaire > 0 €
# L'assertion ci-dessus n'est pas explicitée dans le texte mais
# semble de bon sens, peut-être est-elle précisée dans un autre article ?

  assertion l512_1.nombre_minimum_enfants fixé par décret
  règle sous condition
    existe enfant dans ménage.enfants tel que
    enfant.age = l512_3.âge_limite_alinéa_2
# "enfant répond aux autres conditions pour l'ouverture
# du droit aux allocations familiales". À faire: trouver
# ces "autres conditions".
  conséquence l521_1.allocation_forfaitaire_versée rempli
*/


Le montant des allocations mentionnées aux deux premiers alinéas du présent article, ainsi que celui des majorations mentionnées à l'article L. 521-3 varient en fonction des ressources du ménage ou de la personne qui a la charge des enfants, selon un barème défini par décret.
/*
champ d'application AllocationsFamiliales :
  assertion l512_1.allocations_familiales fixé par décret
  assertion l512_1.allocations_familiales varie avec ménage.ressources
  assertion l521_3.majorations_allocations_familiales fixé par décret
  assertion l512_1.majorations_allocations_familiales varie avec
     ménage.ressources
*/

Le montant des allocations familiales varie en fonction du nombre d'enfants à charge.
/*
champ d'application AllocationsFamiliales :
  assertion l512_1.allocations_familiales varie avec
     nombre de ménage.enfants
*/

Les niveaux des plafonds de ressources, qui varient en fonction du nombre d'enfants à charge, sont révisés conformément à l'évolution annuelle de l'indice des prix à la consommation, hors tabac.
/*
# Pour formaliser l'évolution des prix, il faudrait recopier ici
# tous les décrets d'application qui fixent la valeur des plafonds
# de ressources. Si cela reste possible à faire pour notre langage,
# nous avons choisi de ne pas inclure tout ce code dans ce document.
*/

Un complément dégressif est versé lorsque les ressources du bénéficiaire dépassent l'un des plafonds, dans la limite de montants définis par décret. Les modalités de calcul de ces montants et celles du complément dégressif sont définies par décret.
/*
# Ditto, le volume du code à inclure pour formaliser cette assertion
# est assez important et nous avons choisi de ne pas l'inclure dans ce
# document.
*/


@Article L521-3@ Chacun des enfants à charge, à l'exception du plus âgé, ouvre droit à partir d'un âge minimum à une majoration des allocations familiales.
/*
champ d'application AllocationsFamiliales :
  règle sous condition
    existe enfant dans ménage.enfants tel que
      (enfant != ménage.enfant_plus_âgé) et
      (enfant.âge >= l521_3.âge_limite_alinéa_1 de enfant)
  conséquence l521_3.droits_ouverts_majorations_allocations_familiales rempli
*/

Toutefois, les personnes ayant un nombre déterminé d'enfants à charge bénéficient de ladite majoration pour chaque enfant à charge à partir de l'âge mentionné au premier alinéa.
/*
champ d'application AllocationsFamiliales :
  règle sous condition
    nombre de ménage.enfants >= l512_3.minimum_alinéa_2 et
    (existe enfant dans ménage.enfants tel que
      enfant.âge >= l521_3.âge_limite_alinéa_1 de enfant)
  conséquence l521_3.droits_ouverts_majorations_allocations_familiales rempli
*/

@Article R521-1@ L'âge mentionné au premier alinéa de l'article L. 521-3 à partir duquel les enfants ouvrent droit à la majoration des allocations familiales est fixé à 14 ans.
/*
champ d'application AllocationsFamiliales :
  définition l521_3.âge_limite_alinéa_1 de enfant égal à 14 an
*/

Le nombre minimum d'enfants à charge, mentionné au deuxième alinéa de l'article L. 521-3 ouvrant droit à ladite majoration pour chaque enfant est fixé à trois.
/*
champ d'application AllocationsFamiliales :
  définition l521_3.minimum_alinéa_2
    égal à 3
*/

NOTA : Décret n° 2008-409 du 28 avril 2008 JORF du 29 avril 2008 art. 2 : Les modifications induites par le décret n° 2008-409 s'appliquent aux enfants dont le onzième anniversaire est postérieur au 30 avril 2008.
/*
# Notons ici un champ d'application différent, correspondant à une ancienne
# version du corpus législatif dont un morceau s'applique encore. Nous avons
# choisi de montrer ce vieux champ d'application ici plutôt qu'à côté du texte
# du décret de 2008 pour des raisons de place seulement.
champ d'application AllocationFamilialesAvril2008:
# Âge limite avant décret n° 2008-409 du 28 avril 2008
  définition l521_3.minimum_alinéa_2 de enfant égal à 16 an

champ d'application AllocationsFamiliales :
  définition l521_3.minimum_alinéa_2 de enfant
  sous condition (enfant.date_naissance + 11 an <= 30/04/2008)
  conséquence égal à
    AllocationFamilialesAvril2008.l521_3.minimum_alinéa_2 de enfant
*/
